{"ast":null,"code":"import _objectSpread from\"/home/www/autoparts/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/www/autoparts/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import SimpleDataTable from\"./Common/DataTable\";import Modal from\"./Modal\";import axios from\"axios\";import Popup from\"./Popup\";import ChangePass from\"./ChangePass\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var setCookie=function setCookie(options){var name=options.name,_options$value=options.value,value=_options$value===void 0?\"\":_options$value,_options$path=options.path,path=_options$path===void 0?\"/\":_options$path,_options$duration=options.duration,duration=_options$duration===void 0?3600:_options$duration;var durationMs=duration*1000;var expires=new Date(Date.now()+durationMs);document.cookie=\"\".concat(name,\"=\").concat(escape(value),\"; expires=\").concat(expires.toUTCString(),\"; path=\").concat(path);};var deleteCookie=function deleteCookie(name){setCookie({name:name,value:undefined,duration:-1});};var ClientsTable=function ClientsTable(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showAddNewModal=_useState2[0],setShowAddNewModal=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),confirm=_useState4[0],setConfirm=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),recordsData=_useState6[0],setRecordsData=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),editable=_useState8[0],setEditable=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),title=_useState10[0],setTitle=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),buttonText=_useState12[0],setButtonText=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),activeRecord=_useState14[0],setActiveRecord=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),addNew=_useState16[0],setAddNew=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),showPassChange=_useState18[0],setShowPassChange=_useState18[1];useEffect(function(){axios(\"/records\").then(function(response){var recordsList=response.data;setRecordsData(recordsList.data);}).catch(function(){console.log(\"records was not loaded\");});},[]);var actions={main:{add:function add(){setShowAddNewModal(true);setEditable(true);setTitle(\"ახალი ჩანაწერის დამატება\");setButtonText(\"დამატება\");setAddNew(true);},changePassword:function changePassword(){return setShowPassChange(true);},logOut:function logOut(){deleteCookie(\"sessionId\");window.location.href=\"/\";}},individual:{კორექტირება:function კორექტირება(rec){return handle.edit(rec);},წაშლა:function წაშლა(rec){return handle.delete(rec);},ნახვა:function ნახვა(rec){return handle.view(rec);},მონიშვნა:function მონიშვნა(rec){return handle.select(rec);}}};var handle={edit:function edit(e){setShowAddNewModal(true);setActiveRecord(_objectSpread({},e));setEditable(true);setTitle(\"ჩანაწერის რედაქტირება\");setButtonText(\"შენახვა\");setAddNew(false);},delete:function _delete(e){setConfirm(true);setActiveRecord(_objectSpread({},e));},view:function view(e){setShowAddNewModal(true);setActiveRecord(_objectSpread({},e));setEditable(false);setTitle(\"ჩანაწერი\");setAddNew(false);},select:function select(e){axios.put(\"/select/\".concat(e.clientId)).then(function(response){var setSelected=recordsData.map(function(rec){if(rec.clientId===e.clientId){return _objectSpread(_objectSpread({},rec),{},{selected:true});}else{return _objectSpread({},rec);}});setRecordsData(setSelected);alert(response.data.message);}).catch(function(err){alert(err.response.data.message);});}};return/*#__PURE__*/_jsxs(_Fragment,{children:[showPassChange&&/*#__PURE__*/_jsx(ChangePass,{hideModal:setShowPassChange}),confirm&&/*#__PURE__*/_jsx(Popup,{hideModal:setConfirm,active:activeRecord,records:recordsData,setRecords:setRecordsData}),showAddNewModal&&/*#__PURE__*/_jsx(Modal,{onEdit:editable,title:title,buttonText:buttonText,hideModal:setShowAddNewModal,record:activeRecord,addRecord:setRecordsData,recordsList:recordsData,addNew:addNew}),/*#__PURE__*/_jsx(SimpleDataTable,{items:recordsData,searchable:[\"mark\",\"model\",\"phone\",\"location\",\"comment\"],actions:actions})]});};export default ClientsTable;","map":{"version":3,"names":["React","useEffect","useState","SimpleDataTable","Modal","axios","Popup","ChangePass","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","setCookie","options","name","_options$value","value","_options$path","path","_options$duration","duration","durationMs","expires","Date","now","document","cookie","concat","escape","toUTCString","deleteCookie","undefined","ClientsTable","_useState","_useState2","_slicedToArray","showAddNewModal","setShowAddNewModal","_useState3","_useState4","confirm","setConfirm","_useState5","_useState6","recordsData","setRecordsData","_useState7","_useState8","editable","setEditable","_useState9","_useState10","title","setTitle","_useState11","_useState12","buttonText","setButtonText","_useState13","_useState14","activeRecord","setActiveRecord","_useState15","_useState16","addNew","setAddNew","_useState17","_useState18","showPassChange","setShowPassChange","then","response","recordsList","data","catch","console","log","actions","main","add","changePassword","logOut","window","location","href","individual","კორექტირება","rec","handle","edit","წაშლა","delete","ნახვა","view","მონიშვნა","select","e","_objectSpread","_delete","put","clientId","setSelected","map","selected","alert","message","err","children","hideModal","active","records","setRecords","onEdit","record","addRecord","items","searchable"],"sources":["/home/www/autoparts/client/src/Components/ClientsTable.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport SimpleDataTable from \"./Common/DataTable\";\nimport Modal from \"./Modal\";\nimport axios from \"axios\";\nimport Popup from \"./Popup\";\nimport ChangePass from \"./ChangePass\";\n\nconst setCookie = (options) => {\n  const { name, value = \"\", path = \"/\", duration = 3600 } = options;\n\n  const durationMs = duration * 1000;\n  const expires = new Date(Date.now() + durationMs);\n\n  document.cookie = `${name}=${escape(\n    value\n  )}; expires=${expires.toUTCString()}; path=${path}`;\n};\n\nconst deleteCookie = (name) => {\n  setCookie({\n    name: name,\n    value: undefined,\n    duration: -1,\n  });\n};\n\nconst ClientsTable = () => {\n  const [showAddNewModal, setShowAddNewModal] = useState(false);\n  const [confirm, setConfirm] = useState(false);\n  const [recordsData, setRecordsData] = useState([]);\n  const [editable, setEditable] = useState(false);\n  const [title, setTitle] = useState(\"\");\n  const [buttonText, setButtonText] = useState(\"\");\n  const [activeRecord, setActiveRecord] = useState({});\n  const [addNew, setAddNew] = useState(false);\n  const [showPassChange, setShowPassChange] = useState(false);\n\n  useEffect(() => {\n    axios(\"/records\")\n      .then((response) => {\n        const recordsList = response.data;\n        setRecordsData(recordsList.data);\n      })\n      .catch(() => {\n        console.log(\"records was not loaded\");\n      });\n  }, []);\n\n  const actions = {\n    main: {\n      add: () => {\n        setShowAddNewModal(true);\n        setEditable(true);\n        setTitle(\"ახალი ჩანაწერის დამატება\");\n        setButtonText(\"დამატება\");\n        setAddNew(true);\n      },\n      changePassword: () => setShowPassChange(true),\n      logOut: () => {\n        deleteCookie(\"sessionId\");\n        window.location.href = \"/\";\n      },\n    },\n    individual: {\n      კორექტირება: (rec) => handle.edit(rec),\n      წაშლა: (rec) => handle.delete(rec),\n      ნახვა: (rec) => handle.view(rec),\n      მონიშვნა: (rec) => handle.select(rec),\n    },\n  };\n\n  const handle = {\n    edit: (e) => {\n      setShowAddNewModal(true);\n      setActiveRecord({ ...e });\n      setEditable(true);\n      setTitle(\"ჩანაწერის რედაქტირება\");\n      setButtonText(\"შენახვა\");\n      setAddNew(false);\n    },\n    delete: (e) => {\n      setConfirm(true);\n      setActiveRecord({ ...e });\n    },\n    view: (e) => {\n      setShowAddNewModal(true);\n      setActiveRecord({ ...e });\n      setEditable(false);\n      setTitle(\"ჩანაწერი\");\n      setAddNew(false);\n    },\n    select: (e) => {\n      axios.put(`/select/${e.clientId}`)\n        .then((response) => {\n          const setSelected = recordsData.map((rec) => {\n            if(rec.clientId === e.clientId) {\n              return {...rec, selected: true}\n            }else{\n              return {...rec}\n            }\n          })\n\n          setRecordsData(setSelected);\n\n          alert(response.data.message)\n        })\n        .catch((err) => {\n          alert(err.response.data.message)\n        })\n    },\n  };\n\n  return (\n    <>\n      {showPassChange && <ChangePass hideModal={setShowPassChange} />}\n      {confirm && (\n        <Popup\n          hideModal={setConfirm}\n          active={activeRecord}\n          records={recordsData}\n          setRecords={setRecordsData}\n        />\n      )}\n      {showAddNewModal && (\n        <Modal\n          onEdit={editable}\n          title={title}\n          buttonText={buttonText}\n          hideModal={setShowAddNewModal}\n          record={activeRecord}\n          addRecord={setRecordsData}\n          recordsList={recordsData}\n          addNew={addNew}\n        />\n      )}\n      <SimpleDataTable\n        items={recordsData}\n        searchable={[\"mark\", \"model\", \"phone\", \"location\", \"comment\"]}\n        actions={actions}\n      />\n    </>\n  );\n};\n\nexport default ClientsTable;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}